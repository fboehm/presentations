---
title: "Large uncertainty in individual polygenic risk score estimation impacts PRS-based risk stratification"
subtitle: "Ding, et al. (2022)"  
author: 
  - "Presented by Fred Boehm"
date: 'June 10, 2022'
bibliography: ../zhou-lab-March-2022/polygenic.bib
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = FALSE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color = "#1381B0",
  secondary_color = "#FF961C",
  inverse_header_color = "#FFFFFF"
)
```

```{r, load_refs, include=FALSE, cache=FALSE}
library(RefManageR)
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "alphabetic",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("../zhou-lab-March-2022/polygenic.bib", check = FALSE)
```








class: center middle


# Prediction intervals for PGS





---

## Existing approaches to prediction intervals in PRS

1. Mondrian cross-conformal prediction intervals for PRS `r Citep(myBib, "sun_translating_2021")`
  - One approach to conformal prediction 
1. Bayesian credible intervals for PRS `r Citep(myBib, "ding_large_2021")`
  - ldpred2 used to obtain posterior samples
  - Observe large variances in PRS

---

## Importance of prediction intervals for PGS

- Clinical utility of an interval estimate in addition to point estimate
- Large variability in PRS with ldpred2 



---

## LD and finite GWAS sample size introduce uncertainty into PRS estimation


```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig1_HTML.png")
```

---

## GWAS sample size and causal effect size impact the relative ordering of marginal GWAS effects at tag versus true causal SNPs

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig7_ESM.jpg")
```










---

## Extracting uncertainty from Bayesian methods for probabilistic PRS-based stratification

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig2_HTML.png")
```


---

## Expected sd is highly correlated with average sd across testing subjects

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig3_HTML.png")
```

---

## Analytical estimator of sd provides an approximately unbiased estimates of average sd of testing individuals

```{r, out.height=400, out.width=1100}
knitr::include_graphics("ding_figures/41588_2021_961_Fig8_ESM.jpg")
```







---

## Genetic architecture and sample size impact uncertainty in PRS estimates in simulations

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig4_HTML.png")
```

---

## Calibration of $\rho$-level genetic value credible interval with respect to proportion of causal effects and SNP-heritability in testing individuals

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig9_ESM.jpg")
```


---

## Distribution of individual PRS absolute standard deviation with respect to polygenicity under different heritability

```{r, out.height=400, out.width=900}
knitr::include_graphics("ding_figures/41588_2021_961_Fig10_ESM.jpg")
```

---

## Distribution of individual PRS absolute standard deviation with respect to heritability under different polygenicity

```{r, out.height=400, out.width=900}
knitr::include_graphics("ding_figures/41588_2021_961_Fig11_ESM.jpg")
```





---

## Uncertainty in real data and its influence on PRS-based stratification

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig5_HTML.png")
```


---

## Stratification uncertainty at different thresholds and credible set levels

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig6_HTML.png")
```


---

## Individual ranking is consistent when ranking by PRS estimates versus probability of genetic value above threshold

```{r, out.height=400, out.width=600}
knitr::include_graphics("ding_figures/41588_2021_961_Fig16_ESM.jpg")
```




---

## References

```{r refs, echo=FALSE, results="asis"}
PrintBibliography(myBib)
```


